{% extends "layouts/app.html" %}
{% import "bootstrap/wtf.html" as wtf %}

{% block head %}
	{{ super() }}
	{{ ckeditor.load() }}
{% endblock head %}

{% block scripts %}
	{{ super() }}
	<script type="text/javascript">
		$("#cart").click(function(e){
			e.preventDefault();
			{% if current_user.is_anonymous %}
				window.location = "{{ url_for('login', _external=True, next=url_for('show_normal', product_id=product.id|string)) }}";
			{% endif %}

			console.log(123);

			var data = {
				csrf_token: $("#csrf_token").val(),
				cart: true,
			};

			$.ajax({
				type:"POST",
				url: "{{ url_for('show_normal', product_id=product.id|string) }}",
				data: data,
				success: function(data) {
					$("#cart").text(data);
				}
			});
		});

		$("#like").click(function(e){
			e.preventDefault();
			{% if current_user.is_anonymous %}
				window.location = "{{ url_for('login', _external=True, next=url_for('show_normal', product_id=product.id|string)) }}";
			{% endif %}

			var data = {
				csrf_token: $("#csrf_token").val(),
				like: true,
			};

			$.ajax({
				type:"POST",
				url: "{{ url_for('show_normal', product_id=product.id|string) }}",
				data: data,
				success: function(data) {
					$("#like-icon").attr('class', data);
				}
			});
		});
	</script>
{% endblock scripts %}

{% block page %}
	<div class="row">
		<div class="col-lg-12">
	    	{{ product_json }}

	    	<form id="form" role="form">
        		{{ form.csrf_token }}
	    		<button id="like" name="like" type="submit" class="btn btn-link" style="color: red;"><i id="like-icon" class="{{ like }}"></i></button>
	    		<button id="cart" name="cart" type="submit" class="btn btn-sencondary">{{ cart }}</button>
	    	</form>
	    </div>
	</div>
{% endblock page %}